<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mortgage Calculator</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    :root {
      --primary-color: #2196F3;
      --surface-color: #ffffff;
      --background-color: #f5f5f5;
      --border-color: #e0e0e0;
    }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: var(--background-color);
      color: #333;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background: var(--surface-color);
      border-radius: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .input-section, .results-section {
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      background: var(--surface-color);
    }

    .input-group {
      margin-bottom: 20px;
      position: relative;
    }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .input-group input {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);
    }

    .tooltip {
      position: relative;
      display: inline-block;
      margin-left: 8px;
      cursor: help;
    }

    .tooltip::after {
      content: "?";
      display: inline-block;
      width: 18px;
      height: 18px;
      line-height: 18px;
      text-align: center;
      border-radius: 50%;
      background-color: #e0e0e0;
      color: #666;
      font-size: 12px;
    }

    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }

    .tooltip-text {
      visibility: hidden;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      padding: 8px;
      background-color: #333;
      color: white;
      text-align: center;
      border-radius: 4px;
      font-size: 12px;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .result-card {
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      text-align: center;
    }

    .result-card h3 {
      margin: 0 0 10px 0;
      font-size: 16px;
      color: #666;
    }

    .result-value {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary-color);
    }

    .chart-container {
      height: 400px;
      margin-top: 20px;
    }

    @media (max-width: 600px) {
      .container {
        padding: 10px;
      }
      
      .results-grid {
        grid-template-columns: 1fr;
      }
      
      .result-card {
        padding: 15px;
      }
      
      .result-value {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Mortgage Calculator</h1>
    
    <div class="input-section">
      <div class="input-group">
        <label>Home Price ($)
          <span class="tooltip">
            <span class="tooltip-text">The total price of the property</span>
          </span>
        </label>
        <input type="number" id="homePrice" placeholder="300000" value="300000">
      </div>

      <div class="input-group">
        <label>Down Payment ($)
          <span class="tooltip">
            <span class="tooltip-text">Initial payment, typically 20% of home price</span>
          </span>
        </label>
        <input type="number" id="downPayment" placeholder="60000" value="60000">
      </div>

      <div class="input-group">
        <label>Interest Rate (%)
          <span class="tooltip">
            <span class="tooltip-text">Annual interest rate for the mortgage</span>
          </span>
        </label>
        <input type="number" id="interestRate" placeholder="6.5" value="6.5" step="0.01">
      </div>

      <div class="input-group">
        <label>Loan Term (Years)
          <span class="tooltip">
            <span class="tooltip-text">Length of the mortgage in years</span>
          </span>
        </label>
        <input type="number" id="loanTerm" placeholder="30" value="30">
      </div>

      <div class="input-group">
        <label>Property Tax ($/year)
          <span class="tooltip">
            <span class="tooltip-text">Annual property tax amount</span>
          </span>
        </label>
        <input type="number" id="propertyTax" placeholder="3600" value="3600">
      </div>

      <div class="input-group">
        <label>Insurance ($/year)
          <span class="tooltip">
            <span class="tooltip-text">Annual homeowner's insurance cost</span>
          </span>
        </label>
        <input type="number" id="insurance" placeholder="1200" value="1200">
      </div>
    </div>

    <div class="results-section">
      <div class="results-grid">
        <div class="result-card">
          <h3>Monthly Principal & Interest</h3>
          <div class="result-value" id="monthlyPI">$0</div>
        </div>
        <div class="result-card">
          <h3>Monthly PITI Payment</h3>
          <div class="result-value" id="monthlyPITI">$0</div>
        </div>
        <div class="result-card">
          <h3>Total Interest Paid</h3>
          <div class="result-value" id="totalInterest">$0</div>
        </div>
        <div class="result-card">
          <h3>Total Cost</h3>
          <div class="result-value" id="totalCost">$0</div>
        </div>
      </div>
      <div class="chart-container" id="paymentChart"></div>
    </div>
  </div>

  <script>
    function calculateMortgage() {
      // Get input values
      const homePrice = parseFloat(document.getElementById('homePrice').value) || 0;
      const downPayment = parseFloat(document.getElementById('downPayment').value) || 0;
      const interestRate = parseFloat(document.getElementById('interestRate').value) || 0;
      const loanTerm = parseFloat(document.getElementById('loanTerm').value) || 0;
      const propertyTax = parseFloat(document.getElementById('propertyTax').value) || 0;
      const insurance = parseFloat(document.getElementById('insurance').value) || 0;

      // Validate inputs
      if (homePrice <= 0 || downPayment < 0 || interestRate < 0 || loanTerm <= 0) {
        alert('Please enter valid positive numbers');
        return;
      }

      // Calculate loan amount
      const loanAmount = homePrice - downPayment;
      
      // Calculate monthly interest rate
      const monthlyRate = (interestRate / 100) / 12;
      
      // Calculate number of payments
      const numberOfPayments = loanTerm * 12;

      // Calculate monthly P&I payment
      const monthlyPI = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / 
                       (Math.pow(1 + monthlyRate, numberOfPayments) - 1);

      // Calculate monthly tax and insurance
      const monthlyTax = propertyTax / 12;
      const monthlyInsurance = insurance / 12;

      // Calculate total monthly payment (PITI)
      const monthlyPITI = monthlyPI + monthlyTax + monthlyInsurance;

      // Calculate total interest
      const totalInterest = (monthlyPI * numberOfPayments) - loanAmount;

      // Calculate total cost
      const totalCost = (monthlyPITI * numberOfPayments) + downPayment;

      // Update results
      document.getElementById('monthlyPI').textContent = formatCurrency(monthlyPI);
      document.getElementById('monthlyPITI').textContent = formatCurrency(monthlyPITI);
      document.getElementById('totalInterest').textContent = formatCurrency(totalInterest);
      document.getElementById('totalCost').textContent = formatCurrency(totalCost);

      // Create payment breakdown chart
      const data = [{
        values: [
          loanAmount,
          totalInterest,
          (propertyTax + insurance) * loanTerm
        ],
        labels: [
          'Principal',
          'Interest',
          'Tax & Insurance'
        ],
        type: 'pie',
        hole: 0.4,
        marker: {
          colors: ['#2196F3', '#FF9800', '#4CAF50']
        }
      }];

      const layout = {
        title: 'Total Payment Breakdown',
        height: 400,
        showlegend: true
      };

      Plotly.newPlot('paymentChart', data, layout);
    }

    function formatCurrency(value) {
      return new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: 'USD',
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
      }).format(value);
    }

    // Add event listeners to all inputs
    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('input', calculateMortgage);
    });

    // Initial calculation
    calculateMortgage();
  </script>
</body>
</html>